# 「精确类型」配套自动发布工具

本工具用以给「精确类型」代码仓库自动发布。

## 主要包（类型工具）发布流程

「精确类型」代码仓库中的类型工具应该是这么发布的：

### 发布开发版本

在一般的开发过程中，变更版本号默认是发布开发版本，也就是带 `dev-<feature>` 标签的版本。
开发版本形如 `<x>.<y>.<z>-dev.<featrue>.<milestone>.<number>` 。其中：

- `<featrue>` 表示当前开发版本所开发的功能特性，比如 `compare` 、 `tail-recursion` 等；
- `<milestone>` 表示目前的开发阶段，比如 `alpha` 、 `beta` 、 `release` 等；
- `<number>` 表示在当前开发阶段迭代的次数，是数字。

比如 `2.0.3-dev.compare.beta.3` 表示是一个在 `2.0.3` 这个非开发版本的基础上，在 `compare` 这项功能上，到达 `beta` 这个开发阶段后，又递增了 `3` 次的开发版本。
递增一次就是 `2.0.3-dev.compare.beta.4` 。

理论上到达 `release` 开发阶段之后，对应特性的开发版本的发布频率就可以大大降低了。
为了避免标签太多，在认为完全开发完一个特性之后，可以把对应的标签给删了。

### 发布前瞻版本

当成熟（也就是到达 `beta` 版本以上）的开发版本足够多时，可以提供一个包含了很多特性的前瞻版本给人用。
这种版本带 `next` 标签，版本号形如 `<x>.<y>.<z>-next` 。

前瞻版本包含的特性越多， `<z>` 越大。
比如在 `3.1.2` 版本的基础上开发了 5 个新特性，想要一块作为前瞻版本发布了，那么版本号就是 `3.1.7-next` 。

### 更新前瞻版本

前瞻版本的更新是直接递增末尾版本号。比如 `2.3.4-next` 的下一个版本号是 `2.3.5-next` 。

如果前瞻版本出了一个或多个 bug ，然后这些个 bug 已经在最新的开发版本中修复了，那么就可以递增一下版本号。
或者如果前瞻版本所包含的其中一个特性的开发版本到达了新的开发阶段，那也可以递增一下。

### 发布正式版本

如果一个前瞻版本中所有的特性都到达了 `release` 开发阶段，那就可以把这些特性都包含起来，作为正式版本发布。
正式版本的标签是 `latest` ，形如 `<x>.<y>.<z>` 。
比如一个前瞻版本是 `5.3.4-next` ，当这个版本对应的所有开发版本分支都到达 `release` 开发阶段后，它的下一个版本不是 `5.3.5-next` ，而是 `5.3.4` 。

### 更新正式版本

当正式版本中出现 bug 时，不再通过迭代开发版本来修复，而是直接在正式版本的基础上递增版本。

如果一个 bug 太大，以至于一次版本递增没法完全修复，那么把它当成一个特性来开发。
这个特性最好由 `fix-` 开头命名。

## 其他包发布流程

对于其他包，对应的发布流程各有不同。
比如 `eslint-plugin-accurtype-style` 这个包由于代码简单，可以直接在正式版本上开发、迭代。
但其他包的开发流程只能是主要包开发流程的简化版，而不能是更复杂的版本，否则不便于管理版本。
